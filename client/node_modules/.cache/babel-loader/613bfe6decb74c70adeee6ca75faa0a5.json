{"ast":null,"code":"var _classCallCheck = require(\"/home/giorgir/Desktop/web projects/discord-mern/client/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _createClass = require(\"/home/giorgir/Desktop/web projects/discord-mern/client/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nvar _possibleConstructorReturn = require(\"/home/giorgir/Desktop/web projects/discord-mern/client/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js\").default;\n\nvar _inherits = require(\"/home/giorgir/Desktop/web projects/discord-mern/client/node_modules/@babel/runtime/helpers/inherits.js\").default;\n\nvar _createSuper = require(\"/home/giorgir/Desktop/web projects/discord-mern/client/node_modules/@babel/runtime/helpers/createSuper.js\").default;\n\n/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */\nvar debug = require('debug')('simple-peer');\n\nvar getBrowserRTC = require('get-browser-rtc');\n\nvar randombytes = require('randombytes');\n\nvar stream = require('readable-stream');\n\nvar queueMicrotask = require('queue-microtask'); // TODO: remove when Node 10 is not supported\n\n\nvar errCode = require('err-code');\n\nvar _require = require('buffer'),\n    Buffer = _require.Buffer;\n\nvar MAX_BUFFERED_AMOUNT = 64 * 1024;\nvar ICECOMPLETE_TIMEOUT = 5 * 1000;\nvar CHANNEL_CLOSING_TIMEOUT = 5 * 1000; // HACK: Filter trickle lines when trickle is disabled #354\n\nfunction filterTrickle(sdp) {\n  return sdp.replace(/a=ice-options:trickle\\s\\n/g, '');\n}\n\nfunction warn(message) {\n  console.warn(message);\n}\n/**\n * WebRTC peer connection. Same API as node core `net.Socket`, plus a few extra methods.\n * Duplex stream.\n * @param {Object} opts\n */\n\n\nvar Peer = /*#__PURE__*/function (_stream$Duplex) {\n  \"use strict\";\n\n  _inherits(Peer, _stream$Duplex);\n\n  var _super = _createSuper(Peer);\n\n  function Peer(opts) {\n    var _this;\n\n    _classCallCheck(this, Peer);\n\n    opts = Object.assign({\n      allowHalfOpen: false\n    }, opts);\n    _this = _super.call(this, opts);\n    _this._id = randombytes(4).toString('hex').slice(0, 7);\n\n    _this._debug('new peer %o', opts);\n\n    _this.channelName = opts.initiator ? opts.channelName || randombytes(20).toString('hex') : null;\n    _this.initiator = opts.initiator || false;\n    _this.channelConfig = opts.channelConfig || Peer.channelConfig;\n    _this.channelNegotiated = _this.channelConfig.negotiated;\n    _this.config = Object.assign({}, Peer.config, opts.config);\n    _this.offerOptions = opts.offerOptions || {};\n    _this.answerOptions = opts.answerOptions || {};\n\n    _this.sdpTransform = opts.sdpTransform || function (sdp) {\n      return sdp;\n    };\n\n    _this.streams = opts.streams || (opts.stream ? [opts.stream] : []); // support old \"stream\" option\n\n    _this.trickle = opts.trickle !== undefined ? opts.trickle : true;\n    _this.allowHalfTrickle = opts.allowHalfTrickle !== undefined ? opts.allowHalfTrickle : false;\n    _this.iceCompleteTimeout = opts.iceCompleteTimeout || ICECOMPLETE_TIMEOUT;\n    _this.destroyed = false;\n    _this.destroying = false;\n    _this._connected = false;\n    _this.remoteAddress = undefined;\n    _this.remoteFamily = undefined;\n    _this.remotePort = undefined;\n    _this.localAddress = undefined;\n    _this.localFamily = undefined;\n    _this.localPort = undefined;\n    _this._wrtc = opts.wrtc && typeof opts.wrtc === 'object' ? opts.wrtc : getBrowserRTC();\n\n    if (!_this._wrtc) {\n      if (typeof window === 'undefined') {\n        throw errCode(new Error('No WebRTC support: Specify `opts.wrtc` option in this environment'), 'ERR_WEBRTC_SUPPORT');\n      } else {\n        throw errCode(new Error('No WebRTC support: Not a supported browser'), 'ERR_WEBRTC_SUPPORT');\n      }\n    }\n\n    _this._pcReady = false;\n    _this._channelReady = false;\n    _this._iceComplete = false; // ice candidate trickle done (got null candidate)\n\n    _this._iceCompleteTimer = null; // send an offer/answer anyway after some timeout\n\n    _this._channel = null;\n    _this._pendingCandidates = [];\n    _this._isNegotiating = false; // is this peer waiting for negotiation to complete?\n\n    _this._firstNegotiation = true;\n    _this._batchedNegotiation = false; // batch synchronous negotiations\n\n    _this._queuedNegotiation = false; // is there a queued negotiation request?\n\n    _this._sendersAwaitingStable = [];\n    _this._senderMap = new Map();\n    _this._closingInterval = null;\n    _this._remoteTracks = [];\n    _this._remoteStreams = [];\n    _this._chunk = null;\n    _this._cb = null;\n    _this._interval = null;\n\n    try {\n      _this._pc = new _this._wrtc.RTCPeerConnection(_this.config);\n    } catch (err) {\n      _this.destroy(errCode(err, 'ERR_PC_CONSTRUCTOR'));\n\n      return _possibleConstructorReturn(_this);\n    } // We prefer feature detection whenever possible, but sometimes that's not\n    // possible for certain implementations.\n\n\n    _this._isReactNativeWebrtc = typeof _this._pc._peerConnectionId === 'number';\n\n    _this._pc.oniceconnectionstatechange = function () {\n      _this._onIceStateChange();\n    };\n\n    _this._pc.onicegatheringstatechange = function () {\n      _this._onIceStateChange();\n    };\n\n    _this._pc.onconnectionstatechange = function () {\n      _this._onConnectionStateChange();\n    };\n\n    _this._pc.onsignalingstatechange = function () {\n      _this._onSignalingStateChange();\n    };\n\n    _this._pc.onicecandidate = function (event) {\n      _this._onIceCandidate(event);\n    }; // HACK: Fix for odd Firefox behavior, see: https://github.com/feross/simple-peer/pull/783\n\n\n    if (typeof _this._pc.peerIdentity === 'object') {\n      _this._pc.peerIdentity.catch(function (err) {\n        _this.destroy(errCode(err, 'ERR_PC_PEER_IDENTITY'));\n      });\n    } // Other spec events, unused by this implementation:\n    // - onconnectionstatechange\n    // - onicecandidateerror\n    // - onfingerprintfailure\n    // - onnegotiationneeded\n\n\n    if (_this.initiator || _this.channelNegotiated) {\n      _this._setupData({\n        channel: _this._pc.createDataChannel(_this.channelName, _this.channelConfig)\n      });\n    } else {\n      _this._pc.ondatachannel = function (event) {\n        _this._setupData(event);\n      };\n    }\n\n    if (_this.streams) {\n      _this.streams.forEach(function (stream) {\n        _this.addStream(stream);\n      });\n    }\n\n    _this._pc.ontrack = function (event) {\n      _this._onTrack(event);\n    };\n\n    _this._debug('initial negotiation');\n\n    _this._needsNegotiation();\n\n    _this._onFinishBound = function () {\n      _this._onFinish();\n    };\n\n    _this.once('finish', _this._onFinishBound);\n\n    return _this;\n  }\n\n  _createClass(Peer, [{\n    key: \"bufferSize\",\n    get: function get() {\n      return this._channel && this._channel.bufferedAmount || 0;\n    } // HACK: it's possible channel.readyState is \"closing\" before peer.destroy() fires\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=882743\n\n  }, {\n    key: \"connected\",\n    get: function get() {\n      return this._connected && this._channel.readyState === 'open';\n    }\n  }, {\n    key: \"address\",\n    value: function address() {\n      return {\n        port: this.localPort,\n        family: this.localFamily,\n        address: this.localAddress\n      };\n    }\n  }, {\n    key: \"signal\",\n    value: function signal(data) {\n      var _this2 = this;\n\n      if (this.destroying) return;\n      if (this.destroyed) throw errCode(new Error('cannot signal after peer is destroyed'), 'ERR_DESTROYED');\n\n      if (typeof data === 'string') {\n        try {\n          data = JSON.parse(data);\n        } catch (err) {\n          data = {};\n        }\n      }\n\n      this._debug('signal()');\n\n      if (data.renegotiate && this.initiator) {\n        this._debug('got request to renegotiate');\n\n        this._needsNegotiation();\n      }\n\n      if (data.transceiverRequest && this.initiator) {\n        this._debug('got request for transceiver');\n\n        this.addTransceiver(data.transceiverRequest.kind, data.transceiverRequest.init);\n      }\n\n      if (data.candidate) {\n        if (this._pc.remoteDescription && this._pc.remoteDescription.type) {\n          this._addIceCandidate(data.candidate);\n        } else {\n          this._pendingCandidates.push(data.candidate);\n        }\n      }\n\n      if (data.sdp) {\n        this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(data)).then(function () {\n          if (_this2.destroyed) return;\n\n          _this2._pendingCandidates.forEach(function (candidate) {\n            _this2._addIceCandidate(candidate);\n          });\n\n          _this2._pendingCandidates = [];\n          if (_this2._pc.remoteDescription.type === 'offer') _this2._createAnswer();\n        }).catch(function (err) {\n          _this2.destroy(errCode(err, 'ERR_SET_REMOTE_DESCRIPTION'));\n        });\n      }\n\n      if (!data.sdp && !data.candidate && !data.renegotiate && !data.transceiverRequest) {\n        this.destroy(errCode(new Error('signal() called with invalid signal data'), 'ERR_SIGNALING'));\n      }\n    }\n  }, {\n    key: \"_addIceCandidate\",\n    value: function _addIceCandidate(candidate) {\n      var _this3 = this;\n\n      var iceCandidateObj = new this._wrtc.RTCIceCandidate(candidate);\n\n      this._pc.addIceCandidate(iceCandidateObj).catch(function (err) {\n        if (!iceCandidateObj.address || iceCandidateObj.address.endsWith('.local')) {\n          warn('Ignoring unsupported ICE candidate.');\n        } else {\n          _this3.destroy(errCode(err, 'ERR_ADD_ICE_CANDIDATE'));\n        }\n      });\n    }\n    /**\n     * Send text/binary data to the remote peer.\n     * @param {ArrayBufferView|ArrayBuffer|Buffer|string|Blob} chunk\n     */\n\n  }, {\n    key: \"send\",\n    value: function send(chunk) {\n      if (this.destroying) return;\n      if (this.destroyed) throw errCode(new Error('cannot send after peer is destroyed'), 'ERR_DESTROYED');\n\n      this._channel.send(chunk);\n    }\n    /**\n     * Add a Transceiver to the connection.\n     * @param {String} kind\n     * @param {Object} init\n     */\n\n  }, {\n    key: \"addTransceiver\",\n    value: function addTransceiver(kind, init) {\n      if (this.destroying) return;\n      if (this.destroyed) throw errCode(new Error('cannot addTransceiver after peer is destroyed'), 'ERR_DESTROYED');\n\n      this._debug('addTransceiver()');\n\n      if (this.initiator) {\n        try {\n          this._pc.addTransceiver(kind, init);\n\n          this._needsNegotiation();\n        } catch (err) {\n          this.destroy(errCode(err, 'ERR_ADD_TRANSCEIVER'));\n        }\n      } else {\n        this.emit('signal', {\n          // request initiator to renegotiate\n          type: 'transceiverRequest',\n          transceiverRequest: {\n            kind: kind,\n            init: init\n          }\n        });\n      }\n    }\n    /**\n     * Add a MediaStream to the connection.\n     * @param {MediaStream} stream\n     */\n\n  }, {\n    key: \"addStream\",\n    value: function addStream(stream) {\n      var _this4 = this;\n\n      if (this.destroying) return;\n      if (this.destroyed) throw errCode(new Error('cannot addStream after peer is destroyed'), 'ERR_DESTROYED');\n\n      this._debug('addStream()');\n\n      stream.getTracks().forEach(function (track) {\n        _this4.addTrack(track, stream);\n      });\n    }\n    /**\n     * Add a MediaStreamTrack to the connection.\n     * @param {MediaStreamTrack} track\n     * @param {MediaStream} stream\n     */\n\n  }, {\n    key: \"addTrack\",\n    value: function addTrack(track, stream) {\n      if (this.destroying) return;\n      if (this.destroyed) throw errCode(new Error('cannot addTrack after peer is destroyed'), 'ERR_DESTROYED');\n\n      this._debug('addTrack()');\n\n      var submap = this._senderMap.get(track) || new Map(); // nested Maps map [track, stream] to sender\n\n      var sender = submap.get(stream);\n\n      if (!sender) {\n        sender = this._pc.addTrack(track, stream);\n        submap.set(stream, sender);\n\n        this._senderMap.set(track, submap);\n\n        this._needsNegotiation();\n      } else if (sender.removed) {\n        throw errCode(new Error('Track has been removed. You should enable/disable tracks that you want to re-add.'), 'ERR_SENDER_REMOVED');\n      } else {\n        throw errCode(new Error('Track has already been added to that stream.'), 'ERR_SENDER_ALREADY_ADDED');\n      }\n    }\n    /**\n     * Replace a MediaStreamTrack by another in the connection.\n     * @param {MediaStreamTrack} oldTrack\n     * @param {MediaStreamTrack} newTrack\n     * @param {MediaStream} stream\n     */\n\n  }, {\n    key: \"replaceTrack\",\n    value: function replaceTrack(oldTrack, newTrack, stream) {\n      if (this.destroying) return;\n      if (this.destroyed) throw errCode(new Error('cannot replaceTrack after peer is destroyed'), 'ERR_DESTROYED');\n\n      this._debug('replaceTrack()');\n\n      var submap = this._senderMap.get(oldTrack);\n\n      var sender = submap ? submap.get(stream) : null;\n\n      if (!sender) {\n        throw errCode(new Error('Cannot replace track that was never added.'), 'ERR_TRACK_NOT_ADDED');\n      }\n\n      if (newTrack) this._senderMap.set(newTrack, submap);\n\n      if (sender.replaceTrack != null) {\n        sender.replaceTrack(newTrack);\n      } else {\n        this.destroy(errCode(new Error('replaceTrack is not supported in this browser'), 'ERR_UNSUPPORTED_REPLACETRACK'));\n      }\n    }\n    /**\n     * Remove a MediaStreamTrack from the connection.\n     * @param {MediaStreamTrack} track\n     * @param {MediaStream} stream\n     */\n\n  }, {\n    key: \"removeTrack\",\n    value: function removeTrack(track, stream) {\n      if (this.destroying) return;\n      if (this.destroyed) throw errCode(new Error('cannot removeTrack after peer is destroyed'), 'ERR_DESTROYED');\n\n      this._debug('removeSender()');\n\n      var submap = this._senderMap.get(track);\n\n      var sender = submap ? submap.get(stream) : null;\n\n      if (!sender) {\n        throw errCode(new Error('Cannot remove track that was never added.'), 'ERR_TRACK_NOT_ADDED');\n      }\n\n      try {\n        sender.removed = true;\n\n        this._pc.removeTrack(sender);\n      } catch (err) {\n        if (err.name === 'NS_ERROR_UNEXPECTED') {\n          this._sendersAwaitingStable.push(sender); // HACK: Firefox must wait until (signalingState === stable) https://bugzilla.mozilla.org/show_bug.cgi?id=1133874\n\n        } else {\n          this.destroy(errCode(err, 'ERR_REMOVE_TRACK'));\n        }\n      }\n\n      this._needsNegotiation();\n    }\n    /**\n     * Remove a MediaStream from the connection.\n     * @param {MediaStream} stream\n     */\n\n  }, {\n    key: \"removeStream\",\n    value: function removeStream(stream) {\n      var _this5 = this;\n\n      if (this.destroying) return;\n      if (this.destroyed) throw errCode(new Error('cannot removeStream after peer is destroyed'), 'ERR_DESTROYED');\n\n      this._debug('removeSenders()');\n\n      stream.getTracks().forEach(function (track) {\n        _this5.removeTrack(track, stream);\n      });\n    }\n  }, {\n    key: \"_needsNegotiation\",\n    value: function _needsNegotiation() {\n      var _this6 = this;\n\n      this._debug('_needsNegotiation');\n\n      if (this._batchedNegotiation) return; // batch synchronous renegotiations\n\n      this._batchedNegotiation = true;\n      queueMicrotask(function () {\n        _this6._batchedNegotiation = false;\n\n        if (_this6.initiator || !_this6._firstNegotiation) {\n          _this6._debug('starting batched negotiation');\n\n          _this6.negotiate();\n        } else {\n          _this6._debug('non-initiator initial negotiation request discarded');\n        }\n\n        _this6._firstNegotiation = false;\n      });\n    }\n  }, {\n    key: \"negotiate\",\n    value: function negotiate() {\n      var _this7 = this;\n\n      if (this.destroying) return;\n      if (this.destroyed) throw errCode(new Error('cannot negotiate after peer is destroyed'), 'ERR_DESTROYED');\n\n      if (this.initiator) {\n        if (this._isNegotiating) {\n          this._queuedNegotiation = true;\n\n          this._debug('already negotiating, queueing');\n        } else {\n          this._debug('start negotiation');\n\n          setTimeout(function () {\n            // HACK: Chrome crashes if we immediately call createOffer\n            _this7._createOffer();\n          }, 0);\n        }\n      } else {\n        if (this._isNegotiating) {\n          this._queuedNegotiation = true;\n\n          this._debug('already negotiating, queueing');\n        } else {\n          this._debug('requesting negotiation from initiator');\n\n          this.emit('signal', {\n            // request initiator to renegotiate\n            type: 'renegotiate',\n            renegotiate: true\n          });\n        }\n      }\n\n      this._isNegotiating = true;\n    } // TODO: Delete this method once readable-stream is updated to contain a default\n    // implementation of destroy() that automatically calls _destroy()\n    // See: https://github.com/nodejs/readable-stream/issues/283\n\n  }, {\n    key: \"destroy\",\n    value: function destroy(err) {\n      this._destroy(err, function () {});\n    }\n  }, {\n    key: \"_destroy\",\n    value: function _destroy(err, cb) {\n      var _this8 = this;\n\n      if (this.destroyed || this.destroying) return;\n      this.destroying = true;\n\n      this._debug('destroying (error: %s)', err && (err.message || err));\n\n      queueMicrotask(function () {\n        // allow events concurrent with the call to _destroy() to fire (see #692)\n        _this8.destroyed = true;\n        _this8.destroying = false;\n\n        _this8._debug('destroy (error: %s)', err && (err.message || err));\n\n        _this8.readable = _this8.writable = false;\n        if (!_this8._readableState.ended) _this8.push(null);\n        if (!_this8._writableState.finished) _this8.end();\n        _this8._connected = false;\n        _this8._pcReady = false;\n        _this8._channelReady = false;\n        _this8._remoteTracks = null;\n        _this8._remoteStreams = null;\n        _this8._senderMap = null;\n        clearInterval(_this8._closingInterval);\n        _this8._closingInterval = null;\n        clearInterval(_this8._interval);\n        _this8._interval = null;\n        _this8._chunk = null;\n        _this8._cb = null;\n        if (_this8._onFinishBound) _this8.removeListener('finish', _this8._onFinishBound);\n        _this8._onFinishBound = null;\n\n        if (_this8._channel) {\n          try {\n            _this8._channel.close();\n          } catch (err) {} // allow events concurrent with destruction to be handled\n\n\n          _this8._channel.onmessage = null;\n          _this8._channel.onopen = null;\n          _this8._channel.onclose = null;\n          _this8._channel.onerror = null;\n        }\n\n        if (_this8._pc) {\n          try {\n            _this8._pc.close();\n          } catch (err) {} // allow events concurrent with destruction to be handled\n\n\n          _this8._pc.oniceconnectionstatechange = null;\n          _this8._pc.onicegatheringstatechange = null;\n          _this8._pc.onsignalingstatechange = null;\n          _this8._pc.onicecandidate = null;\n          _this8._pc.ontrack = null;\n          _this8._pc.ondatachannel = null;\n        }\n\n        _this8._pc = null;\n        _this8._channel = null;\n        if (err) _this8.emit('error', err);\n\n        _this8.emit('close');\n\n        cb();\n      });\n    }\n  }, {\n    key: \"_setupData\",\n    value: function _setupData(event) {\n      var _this9 = this;\n\n      if (!event.channel) {\n        // In some situations `pc.createDataChannel()` returns `undefined` (in wrtc),\n        // which is invalid behavior. Handle it gracefully.\n        // See: https://github.com/feross/simple-peer/issues/163\n        return this.destroy(errCode(new Error('Data channel event is missing `channel` property'), 'ERR_DATA_CHANNEL'));\n      }\n\n      this._channel = event.channel;\n      this._channel.binaryType = 'arraybuffer';\n\n      if (typeof this._channel.bufferedAmountLowThreshold === 'number') {\n        this._channel.bufferedAmountLowThreshold = MAX_BUFFERED_AMOUNT;\n      }\n\n      this.channelName = this._channel.label;\n\n      this._channel.onmessage = function (event) {\n        _this9._onChannelMessage(event);\n      };\n\n      this._channel.onbufferedamountlow = function () {\n        _this9._onChannelBufferedAmountLow();\n      };\n\n      this._channel.onopen = function () {\n        _this9._onChannelOpen();\n      };\n\n      this._channel.onclose = function () {\n        _this9._onChannelClose();\n      };\n\n      this._channel.onerror = function (event) {\n        var err = event.error instanceof Error ? event.error : new Error(\"Datachannel error: \".concat(event.message, \" \").concat(event.filename, \":\").concat(event.lineno, \":\").concat(event.colno));\n\n        _this9.destroy(errCode(err, 'ERR_DATA_CHANNEL'));\n      }; // HACK: Chrome will sometimes get stuck in readyState \"closing\", let's check for this condition\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=882743\n\n\n      var isClosing = false;\n      this._closingInterval = setInterval(function () {\n        // No \"onclosing\" event\n        if (_this9._channel && _this9._channel.readyState === 'closing') {\n          if (isClosing) _this9._onChannelClose(); // closing timed out: equivalent to onclose firing\n\n          isClosing = true;\n        } else {\n          isClosing = false;\n        }\n      }, CHANNEL_CLOSING_TIMEOUT);\n    }\n  }, {\n    key: \"_read\",\n    value: function _read() {}\n  }, {\n    key: \"_write\",\n    value: function _write(chunk, encoding, cb) {\n      if (this.destroyed) return cb(errCode(new Error('cannot write after peer is destroyed'), 'ERR_DATA_CHANNEL'));\n\n      if (this._connected) {\n        try {\n          this.send(chunk);\n        } catch (err) {\n          return this.destroy(errCode(err, 'ERR_DATA_CHANNEL'));\n        }\n\n        if (this._channel.bufferedAmount > MAX_BUFFERED_AMOUNT) {\n          this._debug('start backpressure: bufferedAmount %d', this._channel.bufferedAmount);\n\n          this._cb = cb;\n        } else {\n          cb(null);\n        }\n      } else {\n        this._debug('write before connect');\n\n        this._chunk = chunk;\n        this._cb = cb;\n      }\n    } // When stream finishes writing, close socket. Half open connections are not\n    // supported.\n\n  }, {\n    key: \"_onFinish\",\n    value: function _onFinish() {\n      var _this10 = this;\n\n      if (this.destroyed) return; // Wait a bit before destroying so the socket flushes.\n      // TODO: is there a more reliable way to accomplish this?\n\n      var destroySoon = function destroySoon() {\n        setTimeout(function () {\n          return _this10.destroy();\n        }, 1000);\n      };\n\n      if (this._connected) {\n        destroySoon();\n      } else {\n        this.once('connect', destroySoon);\n      }\n    }\n  }, {\n    key: \"_startIceCompleteTimeout\",\n    value: function _startIceCompleteTimeout() {\n      var _this11 = this;\n\n      if (this.destroyed) return;\n      if (this._iceCompleteTimer) return;\n\n      this._debug('started iceComplete timeout');\n\n      this._iceCompleteTimer = setTimeout(function () {\n        if (!_this11._iceComplete) {\n          _this11._iceComplete = true;\n\n          _this11._debug('iceComplete timeout completed');\n\n          _this11.emit('iceTimeout');\n\n          _this11.emit('_iceComplete');\n        }\n      }, this.iceCompleteTimeout);\n    }\n  }, {\n    key: \"_createOffer\",\n    value: function _createOffer() {\n      var _this12 = this;\n\n      if (this.destroyed) return;\n\n      this._pc.createOffer(this.offerOptions).then(function (offer) {\n        if (_this12.destroyed) return;\n        if (!_this12.trickle && !_this12.allowHalfTrickle) offer.sdp = filterTrickle(offer.sdp);\n        offer.sdp = _this12.sdpTransform(offer.sdp);\n\n        var sendOffer = function sendOffer() {\n          if (_this12.destroyed) return;\n          var signal = _this12._pc.localDescription || offer;\n\n          _this12._debug('signal');\n\n          _this12.emit('signal', {\n            type: signal.type,\n            sdp: signal.sdp\n          });\n        };\n\n        var onSuccess = function onSuccess() {\n          _this12._debug('createOffer success');\n\n          if (_this12.destroyed) return;\n          if (_this12.trickle || _this12._iceComplete) sendOffer();else _this12.once('_iceComplete', sendOffer); // wait for candidates\n        };\n\n        var onError = function onError(err) {\n          _this12.destroy(errCode(err, 'ERR_SET_LOCAL_DESCRIPTION'));\n        };\n\n        _this12._pc.setLocalDescription(offer).then(onSuccess).catch(onError);\n      }).catch(function (err) {\n        _this12.destroy(errCode(err, 'ERR_CREATE_OFFER'));\n      });\n    }\n  }, {\n    key: \"_requestMissingTransceivers\",\n    value: function _requestMissingTransceivers() {\n      var _this13 = this;\n\n      if (this._pc.getTransceivers) {\n        this._pc.getTransceivers().forEach(function (transceiver) {\n          if (!transceiver.mid && transceiver.sender.track && !transceiver.requested) {\n            transceiver.requested = true; // HACK: Safari returns negotiated transceivers with a null mid\n\n            _this13.addTransceiver(transceiver.sender.track.kind);\n          }\n        });\n      }\n    }\n  }, {\n    key: \"_createAnswer\",\n    value: function _createAnswer() {\n      var _this14 = this;\n\n      if (this.destroyed) return;\n\n      this._pc.createAnswer(this.answerOptions).then(function (answer) {\n        if (_this14.destroyed) return;\n        if (!_this14.trickle && !_this14.allowHalfTrickle) answer.sdp = filterTrickle(answer.sdp);\n        answer.sdp = _this14.sdpTransform(answer.sdp);\n\n        var sendAnswer = function sendAnswer() {\n          if (_this14.destroyed) return;\n          var signal = _this14._pc.localDescription || answer;\n\n          _this14._debug('signal');\n\n          _this14.emit('signal', {\n            type: signal.type,\n            sdp: signal.sdp\n          });\n\n          if (!_this14.initiator) _this14._requestMissingTransceivers();\n        };\n\n        var onSuccess = function onSuccess() {\n          if (_this14.destroyed) return;\n          if (_this14.trickle || _this14._iceComplete) sendAnswer();else _this14.once('_iceComplete', sendAnswer);\n        };\n\n        var onError = function onError(err) {\n          _this14.destroy(errCode(err, 'ERR_SET_LOCAL_DESCRIPTION'));\n        };\n\n        _this14._pc.setLocalDescription(answer).then(onSuccess).catch(onError);\n      }).catch(function (err) {\n        _this14.destroy(errCode(err, 'ERR_CREATE_ANSWER'));\n      });\n    }\n  }, {\n    key: \"_onConnectionStateChange\",\n    value: function _onConnectionStateChange() {\n      if (this.destroyed) return;\n\n      if (this._pc.connectionState === 'failed') {\n        this.destroy(errCode(new Error('Connection failed.'), 'ERR_CONNECTION_FAILURE'));\n      }\n    }\n  }, {\n    key: \"_onIceStateChange\",\n    value: function _onIceStateChange() {\n      if (this.destroyed) return;\n      var iceConnectionState = this._pc.iceConnectionState;\n      var iceGatheringState = this._pc.iceGatheringState;\n\n      this._debug('iceStateChange (connection: %s) (gathering: %s)', iceConnectionState, iceGatheringState);\n\n      this.emit('iceStateChange', iceConnectionState, iceGatheringState);\n\n      if (iceConnectionState === 'connected' || iceConnectionState === 'completed') {\n        this._pcReady = true;\n\n        this._maybeReady();\n      }\n\n      if (iceConnectionState === 'failed') {\n        this.destroy(errCode(new Error('Ice connection failed.'), 'ERR_ICE_CONNECTION_FAILURE'));\n      }\n\n      if (iceConnectionState === 'closed') {\n        this.destroy(errCode(new Error('Ice connection closed.'), 'ERR_ICE_CONNECTION_CLOSED'));\n      }\n    }\n  }, {\n    key: \"getStats\",\n    value: function getStats(cb) {\n      var _this15 = this;\n\n      // statreports can come with a value array instead of properties\n      var flattenValues = function flattenValues(report) {\n        if (Object.prototype.toString.call(report.values) === '[object Array]') {\n          report.values.forEach(function (value) {\n            Object.assign(report, value);\n          });\n        }\n\n        return report;\n      }; // Promise-based getStats() (standard)\n\n\n      if (this._pc.getStats.length === 0 || this._isReactNativeWebrtc) {\n        this._pc.getStats().then(function (res) {\n          var reports = [];\n          res.forEach(function (report) {\n            reports.push(flattenValues(report));\n          });\n          cb(null, reports);\n        }, function (err) {\n          return cb(err);\n        }); // Single-parameter callback-based getStats() (non-standard)\n\n      } else if (this._pc.getStats.length > 0) {\n        this._pc.getStats(function (res) {\n          // If we destroy connection in `connect` callback this code might happen to run when actual connection is already closed\n          if (_this15.destroyed) return;\n          var reports = [];\n          res.result().forEach(function (result) {\n            var report = {};\n            result.names().forEach(function (name) {\n              report[name] = result.stat(name);\n            });\n            report.id = result.id;\n            report.type = result.type;\n            report.timestamp = result.timestamp;\n            reports.push(flattenValues(report));\n          });\n          cb(null, reports);\n        }, function (err) {\n          return cb(err);\n        }); // Unknown browser, skip getStats() since it's anyone's guess which style of\n        // getStats() they implement.\n\n      } else {\n        cb(null, []);\n      }\n    }\n  }, {\n    key: \"_maybeReady\",\n    value: function _maybeReady() {\n      var _this16 = this;\n\n      this._debug('maybeReady pc %s channel %s', this._pcReady, this._channelReady);\n\n      if (this._connected || this._connecting || !this._pcReady || !this._channelReady) return;\n      this._connecting = true; // HACK: We can't rely on order here, for details see https://github.com/js-platform/node-webrtc/issues/339\n\n      var findCandidatePair = function findCandidatePair() {\n        if (_this16.destroyed) return;\n\n        _this16.getStats(function (err, items) {\n          if (_this16.destroyed) return; // Treat getStats error as non-fatal. It's not essential.\n\n          if (err) items = [];\n          var remoteCandidates = {};\n          var localCandidates = {};\n          var candidatePairs = {};\n          var foundSelectedCandidatePair = false;\n          items.forEach(function (item) {\n            // TODO: Once all browsers support the hyphenated stats report types, remove\n            // the non-hypenated ones\n            if (item.type === 'remotecandidate' || item.type === 'remote-candidate') {\n              remoteCandidates[item.id] = item;\n            }\n\n            if (item.type === 'localcandidate' || item.type === 'local-candidate') {\n              localCandidates[item.id] = item;\n            }\n\n            if (item.type === 'candidatepair' || item.type === 'candidate-pair') {\n              candidatePairs[item.id] = item;\n            }\n          });\n\n          var setSelectedCandidatePair = function setSelectedCandidatePair(selectedCandidatePair) {\n            foundSelectedCandidatePair = true;\n            var local = localCandidates[selectedCandidatePair.localCandidateId];\n\n            if (local && (local.ip || local.address)) {\n              // Spec\n              _this16.localAddress = local.ip || local.address;\n              _this16.localPort = Number(local.port);\n            } else if (local && local.ipAddress) {\n              // Firefox\n              _this16.localAddress = local.ipAddress;\n              _this16.localPort = Number(local.portNumber);\n            } else if (typeof selectedCandidatePair.googLocalAddress === 'string') {\n              // TODO: remove this once Chrome 58 is released\n              local = selectedCandidatePair.googLocalAddress.split(':');\n              _this16.localAddress = local[0];\n              _this16.localPort = Number(local[1]);\n            }\n\n            if (_this16.localAddress) {\n              _this16.localFamily = _this16.localAddress.includes(':') ? 'IPv6' : 'IPv4';\n            }\n\n            var remote = remoteCandidates[selectedCandidatePair.remoteCandidateId];\n\n            if (remote && (remote.ip || remote.address)) {\n              // Spec\n              _this16.remoteAddress = remote.ip || remote.address;\n              _this16.remotePort = Number(remote.port);\n            } else if (remote && remote.ipAddress) {\n              // Firefox\n              _this16.remoteAddress = remote.ipAddress;\n              _this16.remotePort = Number(remote.portNumber);\n            } else if (typeof selectedCandidatePair.googRemoteAddress === 'string') {\n              // TODO: remove this once Chrome 58 is released\n              remote = selectedCandidatePair.googRemoteAddress.split(':');\n              _this16.remoteAddress = remote[0];\n              _this16.remotePort = Number(remote[1]);\n            }\n\n            if (_this16.remoteAddress) {\n              _this16.remoteFamily = _this16.remoteAddress.includes(':') ? 'IPv6' : 'IPv4';\n            }\n\n            _this16._debug('connect local: %s:%s remote: %s:%s', _this16.localAddress, _this16.localPort, _this16.remoteAddress, _this16.remotePort);\n          };\n\n          items.forEach(function (item) {\n            // Spec-compliant\n            if (item.type === 'transport' && item.selectedCandidatePairId) {\n              setSelectedCandidatePair(candidatePairs[item.selectedCandidatePairId]);\n            } // Old implementations\n\n\n            if (item.type === 'googCandidatePair' && item.googActiveConnection === 'true' || (item.type === 'candidatepair' || item.type === 'candidate-pair') && item.selected) {\n              setSelectedCandidatePair(item);\n            }\n          }); // Ignore candidate pair selection in browsers like Safari 11 that do not have any local or remote candidates\n          // But wait until at least 1 candidate pair is available\n\n          if (!foundSelectedCandidatePair && (!Object.keys(candidatePairs).length || Object.keys(localCandidates).length)) {\n            setTimeout(findCandidatePair, 100);\n            return;\n          } else {\n            _this16._connecting = false;\n            _this16._connected = true;\n          }\n\n          if (_this16._chunk) {\n            try {\n              _this16.send(_this16._chunk);\n            } catch (err) {\n              return _this16.destroy(errCode(err, 'ERR_DATA_CHANNEL'));\n            }\n\n            _this16._chunk = null;\n\n            _this16._debug('sent chunk from \"write before connect\"');\n\n            var cb = _this16._cb;\n            _this16._cb = null;\n            cb(null);\n          } // If `bufferedAmountLowThreshold` and 'onbufferedamountlow' are unsupported,\n          // fallback to using setInterval to implement backpressure.\n\n\n          if (typeof _this16._channel.bufferedAmountLowThreshold !== 'number') {\n            _this16._interval = setInterval(function () {\n              return _this16._onInterval();\n            }, 150);\n            if (_this16._interval.unref) _this16._interval.unref();\n          }\n\n          _this16._debug('connect');\n\n          _this16.emit('connect');\n        });\n      };\n\n      findCandidatePair();\n    }\n  }, {\n    key: \"_onInterval\",\n    value: function _onInterval() {\n      if (!this._cb || !this._channel || this._channel.bufferedAmount > MAX_BUFFERED_AMOUNT) {\n        return;\n      }\n\n      this._onChannelBufferedAmountLow();\n    }\n  }, {\n    key: \"_onSignalingStateChange\",\n    value: function _onSignalingStateChange() {\n      var _this17 = this;\n\n      if (this.destroyed) return;\n\n      if (this._pc.signalingState === 'stable') {\n        this._isNegotiating = false; // HACK: Firefox doesn't yet support removing tracks when signalingState !== 'stable'\n\n        this._debug('flushing sender queue', this._sendersAwaitingStable);\n\n        this._sendersAwaitingStable.forEach(function (sender) {\n          _this17._pc.removeTrack(sender);\n\n          _this17._queuedNegotiation = true;\n        });\n\n        this._sendersAwaitingStable = [];\n\n        if (this._queuedNegotiation) {\n          this._debug('flushing negotiation queue');\n\n          this._queuedNegotiation = false;\n\n          this._needsNegotiation(); // negotiate again\n\n        } else {\n          this._debug('negotiated');\n\n          this.emit('negotiated');\n        }\n      }\n\n      this._debug('signalingStateChange %s', this._pc.signalingState);\n\n      this.emit('signalingStateChange', this._pc.signalingState);\n    }\n  }, {\n    key: \"_onIceCandidate\",\n    value: function _onIceCandidate(event) {\n      if (this.destroyed) return;\n\n      if (event.candidate && this.trickle) {\n        this.emit('signal', {\n          type: 'candidate',\n          candidate: {\n            candidate: event.candidate.candidate,\n            sdpMLineIndex: event.candidate.sdpMLineIndex,\n            sdpMid: event.candidate.sdpMid\n          }\n        });\n      } else if (!event.candidate && !this._iceComplete) {\n        this._iceComplete = true;\n        this.emit('_iceComplete');\n      } // as soon as we've received one valid candidate start timeout\n\n\n      if (event.candidate) {\n        this._startIceCompleteTimeout();\n      }\n    }\n  }, {\n    key: \"_onChannelMessage\",\n    value: function _onChannelMessage(event) {\n      if (this.destroyed) return;\n      var data = event.data;\n      if (data instanceof ArrayBuffer) data = Buffer.from(data);\n      this.push(data);\n    }\n  }, {\n    key: \"_onChannelBufferedAmountLow\",\n    value: function _onChannelBufferedAmountLow() {\n      if (this.destroyed || !this._cb) return;\n\n      this._debug('ending backpressure: bufferedAmount %d', this._channel.bufferedAmount);\n\n      var cb = this._cb;\n      this._cb = null;\n      cb(null);\n    }\n  }, {\n    key: \"_onChannelOpen\",\n    value: function _onChannelOpen() {\n      if (this._connected || this.destroyed) return;\n\n      this._debug('on channel open');\n\n      this._channelReady = true;\n\n      this._maybeReady();\n    }\n  }, {\n    key: \"_onChannelClose\",\n    value: function _onChannelClose() {\n      if (this.destroyed) return;\n\n      this._debug('on channel close');\n\n      this.destroy();\n    }\n  }, {\n    key: \"_onTrack\",\n    value: function _onTrack(event) {\n      var _this18 = this;\n\n      if (this.destroyed) return;\n      event.streams.forEach(function (eventStream) {\n        _this18._debug('on track');\n\n        _this18.emit('track', event.track, eventStream);\n\n        _this18._remoteTracks.push({\n          track: event.track,\n          stream: eventStream\n        });\n\n        if (_this18._remoteStreams.some(function (remoteStream) {\n          return remoteStream.id === eventStream.id;\n        })) return; // Only fire one 'stream' event, even though there may be multiple tracks per stream\n\n        _this18._remoteStreams.push(eventStream);\n\n        queueMicrotask(function () {\n          _this18._debug('on stream');\n\n          _this18.emit('stream', eventStream); // ensure all tracks have been added\n\n        });\n      });\n    }\n  }, {\n    key: \"_debug\",\n    value: function _debug() {\n      var args = [].slice.call(arguments);\n      args[0] = '[' + this._id + '] ' + args[0];\n      debug.apply(null, args);\n    }\n  }]);\n\n  return Peer;\n}(stream.Duplex);\n\nPeer.WEBRTC_SUPPORT = !!getBrowserRTC();\n/**\n * Expose peer and data channel config for overriding all Peer\n * instances. Otherwise, just set opts.config or opts.channelConfig\n * when constructing a Peer.\n */\n\nPeer.config = {\n  iceServers: [{\n    urls: ['stun:stun.l.google.com:19302', 'stun:global.stun.twilio.com:3478']\n  }],\n  sdpSemantics: 'unified-plan'\n};\nPeer.channelConfig = {};\nmodule.exports = Peer;","map":{"version":3,"names":["debug","require","getBrowserRTC","randombytes","stream","queueMicrotask","errCode","Buffer","MAX_BUFFERED_AMOUNT","ICECOMPLETE_TIMEOUT","CHANNEL_CLOSING_TIMEOUT","filterTrickle","sdp","replace","warn","message","console","Peer","opts","Object","assign","allowHalfOpen","_id","toString","slice","_debug","channelName","initiator","channelConfig","channelNegotiated","negotiated","config","offerOptions","answerOptions","sdpTransform","streams","trickle","undefined","allowHalfTrickle","iceCompleteTimeout","destroyed","destroying","_connected","remoteAddress","remoteFamily","remotePort","localAddress","localFamily","localPort","_wrtc","wrtc","window","Error","_pcReady","_channelReady","_iceComplete","_iceCompleteTimer","_channel","_pendingCandidates","_isNegotiating","_firstNegotiation","_batchedNegotiation","_queuedNegotiation","_sendersAwaitingStable","_senderMap","Map","_closingInterval","_remoteTracks","_remoteStreams","_chunk","_cb","_interval","_pc","RTCPeerConnection","err","destroy","_isReactNativeWebrtc","_peerConnectionId","oniceconnectionstatechange","_onIceStateChange","onicegatheringstatechange","onconnectionstatechange","_onConnectionStateChange","onsignalingstatechange","_onSignalingStateChange","onicecandidate","event","_onIceCandidate","peerIdentity","catch","_setupData","channel","createDataChannel","ondatachannel","forEach","addStream","ontrack","_onTrack","_needsNegotiation","_onFinishBound","_onFinish","once","bufferedAmount","readyState","port","family","address","data","JSON","parse","renegotiate","transceiverRequest","addTransceiver","kind","init","candidate","remoteDescription","type","_addIceCandidate","push","setRemoteDescription","RTCSessionDescription","then","_createAnswer","iceCandidateObj","RTCIceCandidate","addIceCandidate","endsWith","chunk","send","emit","getTracks","track","addTrack","submap","get","sender","set","removed","oldTrack","newTrack","replaceTrack","removeTrack","name","negotiate","setTimeout","_createOffer","_destroy","cb","readable","writable","_readableState","ended","_writableState","finished","end","clearInterval","removeListener","close","onmessage","onopen","onclose","onerror","binaryType","bufferedAmountLowThreshold","label","_onChannelMessage","onbufferedamountlow","_onChannelBufferedAmountLow","_onChannelOpen","_onChannelClose","error","filename","lineno","colno","isClosing","setInterval","encoding","destroySoon","createOffer","offer","sendOffer","signal","localDescription","onSuccess","onError","setLocalDescription","getTransceivers","transceiver","mid","requested","createAnswer","answer","sendAnswer","_requestMissingTransceivers","connectionState","iceConnectionState","iceGatheringState","_maybeReady","flattenValues","report","prototype","call","values","value","getStats","length","res","reports","result","names","stat","id","timestamp","_connecting","findCandidatePair","items","remoteCandidates","localCandidates","candidatePairs","foundSelectedCandidatePair","item","setSelectedCandidatePair","selectedCandidatePair","local","localCandidateId","ip","Number","ipAddress","portNumber","googLocalAddress","split","includes","remote","remoteCandidateId","googRemoteAddress","selectedCandidatePairId","googActiveConnection","selected","keys","_onInterval","unref","signalingState","sdpMLineIndex","sdpMid","_startIceCompleteTimeout","ArrayBuffer","from","eventStream","some","remoteStream","args","arguments","apply","Duplex","WEBRTC_SUPPORT","iceServers","urls","sdpSemantics","module","exports"],"sources":["/home/giorgir/Desktop/web projects/discord-mern/client/node_modules/simple-peer/index.js"],"sourcesContent":["/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */\nconst debug = require('debug')('simple-peer')\nconst getBrowserRTC = require('get-browser-rtc')\nconst randombytes = require('randombytes')\nconst stream = require('readable-stream')\nconst queueMicrotask = require('queue-microtask') // TODO: remove when Node 10 is not supported\nconst errCode = require('err-code')\nconst { Buffer } = require('buffer')\n\nconst MAX_BUFFERED_AMOUNT = 64 * 1024\nconst ICECOMPLETE_TIMEOUT = 5 * 1000\nconst CHANNEL_CLOSING_TIMEOUT = 5 * 1000\n\n// HACK: Filter trickle lines when trickle is disabled #354\nfunction filterTrickle (sdp) {\n  return sdp.replace(/a=ice-options:trickle\\s\\n/g, '')\n}\n\nfunction warn (message) {\n  console.warn(message)\n}\n\n/**\n * WebRTC peer connection. Same API as node core `net.Socket`, plus a few extra methods.\n * Duplex stream.\n * @param {Object} opts\n */\nclass Peer extends stream.Duplex {\n  constructor (opts) {\n    opts = Object.assign({\n      allowHalfOpen: false\n    }, opts)\n\n    super(opts)\n\n    this._id = randombytes(4).toString('hex').slice(0, 7)\n    this._debug('new peer %o', opts)\n\n    this.channelName = opts.initiator\n      ? opts.channelName || randombytes(20).toString('hex')\n      : null\n\n    this.initiator = opts.initiator || false\n    this.channelConfig = opts.channelConfig || Peer.channelConfig\n    this.channelNegotiated = this.channelConfig.negotiated\n    this.config = Object.assign({}, Peer.config, opts.config)\n    this.offerOptions = opts.offerOptions || {}\n    this.answerOptions = opts.answerOptions || {}\n    this.sdpTransform = opts.sdpTransform || (sdp => sdp)\n    this.streams = opts.streams || (opts.stream ? [opts.stream] : []) // support old \"stream\" option\n    this.trickle = opts.trickle !== undefined ? opts.trickle : true\n    this.allowHalfTrickle = opts.allowHalfTrickle !== undefined ? opts.allowHalfTrickle : false\n    this.iceCompleteTimeout = opts.iceCompleteTimeout || ICECOMPLETE_TIMEOUT\n\n    this.destroyed = false\n    this.destroying = false\n    this._connected = false\n\n    this.remoteAddress = undefined\n    this.remoteFamily = undefined\n    this.remotePort = undefined\n    this.localAddress = undefined\n    this.localFamily = undefined\n    this.localPort = undefined\n\n    this._wrtc = (opts.wrtc && typeof opts.wrtc === 'object')\n      ? opts.wrtc\n      : getBrowserRTC()\n\n    if (!this._wrtc) {\n      if (typeof window === 'undefined') {\n        throw errCode(new Error('No WebRTC support: Specify `opts.wrtc` option in this environment'), 'ERR_WEBRTC_SUPPORT')\n      } else {\n        throw errCode(new Error('No WebRTC support: Not a supported browser'), 'ERR_WEBRTC_SUPPORT')\n      }\n    }\n\n    this._pcReady = false\n    this._channelReady = false\n    this._iceComplete = false // ice candidate trickle done (got null candidate)\n    this._iceCompleteTimer = null // send an offer/answer anyway after some timeout\n    this._channel = null\n    this._pendingCandidates = []\n\n    this._isNegotiating = false // is this peer waiting for negotiation to complete?\n    this._firstNegotiation = true\n    this._batchedNegotiation = false // batch synchronous negotiations\n    this._queuedNegotiation = false // is there a queued negotiation request?\n    this._sendersAwaitingStable = []\n    this._senderMap = new Map()\n    this._closingInterval = null\n\n    this._remoteTracks = []\n    this._remoteStreams = []\n\n    this._chunk = null\n    this._cb = null\n    this._interval = null\n\n    try {\n      this._pc = new (this._wrtc.RTCPeerConnection)(this.config)\n    } catch (err) {\n      this.destroy(errCode(err, 'ERR_PC_CONSTRUCTOR'))\n      return\n    }\n\n    // We prefer feature detection whenever possible, but sometimes that's not\n    // possible for certain implementations.\n    this._isReactNativeWebrtc = typeof this._pc._peerConnectionId === 'number'\n\n    this._pc.oniceconnectionstatechange = () => {\n      this._onIceStateChange()\n    }\n    this._pc.onicegatheringstatechange = () => {\n      this._onIceStateChange()\n    }\n    this._pc.onconnectionstatechange = () => {\n      this._onConnectionStateChange()\n    }\n    this._pc.onsignalingstatechange = () => {\n      this._onSignalingStateChange()\n    }\n    this._pc.onicecandidate = event => {\n      this._onIceCandidate(event)\n    }\n\n    // HACK: Fix for odd Firefox behavior, see: https://github.com/feross/simple-peer/pull/783\n    if (typeof this._pc.peerIdentity === 'object') {\n      this._pc.peerIdentity.catch(err => {\n        this.destroy(errCode(err, 'ERR_PC_PEER_IDENTITY'))\n      })\n    }\n\n    // Other spec events, unused by this implementation:\n    // - onconnectionstatechange\n    // - onicecandidateerror\n    // - onfingerprintfailure\n    // - onnegotiationneeded\n\n    if (this.initiator || this.channelNegotiated) {\n      this._setupData({\n        channel: this._pc.createDataChannel(this.channelName, this.channelConfig)\n      })\n    } else {\n      this._pc.ondatachannel = event => {\n        this._setupData(event)\n      }\n    }\n\n    if (this.streams) {\n      this.streams.forEach(stream => {\n        this.addStream(stream)\n      })\n    }\n    this._pc.ontrack = event => {\n      this._onTrack(event)\n    }\n\n    this._debug('initial negotiation')\n    this._needsNegotiation()\n\n    this._onFinishBound = () => {\n      this._onFinish()\n    }\n    this.once('finish', this._onFinishBound)\n  }\n\n  get bufferSize () {\n    return (this._channel && this._channel.bufferedAmount) || 0\n  }\n\n  // HACK: it's possible channel.readyState is \"closing\" before peer.destroy() fires\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=882743\n  get connected () {\n    return (this._connected && this._channel.readyState === 'open')\n  }\n\n  address () {\n    return { port: this.localPort, family: this.localFamily, address: this.localAddress }\n  }\n\n  signal (data) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot signal after peer is destroyed'), 'ERR_DESTROYED')\n    if (typeof data === 'string') {\n      try {\n        data = JSON.parse(data)\n      } catch (err) {\n        data = {}\n      }\n    }\n    this._debug('signal()')\n\n    if (data.renegotiate && this.initiator) {\n      this._debug('got request to renegotiate')\n      this._needsNegotiation()\n    }\n    if (data.transceiverRequest && this.initiator) {\n      this._debug('got request for transceiver')\n      this.addTransceiver(data.transceiverRequest.kind, data.transceiverRequest.init)\n    }\n    if (data.candidate) {\n      if (this._pc.remoteDescription && this._pc.remoteDescription.type) {\n        this._addIceCandidate(data.candidate)\n      } else {\n        this._pendingCandidates.push(data.candidate)\n      }\n    }\n    if (data.sdp) {\n      this._pc.setRemoteDescription(new (this._wrtc.RTCSessionDescription)(data))\n        .then(() => {\n          if (this.destroyed) return\n\n          this._pendingCandidates.forEach(candidate => {\n            this._addIceCandidate(candidate)\n          })\n          this._pendingCandidates = []\n\n          if (this._pc.remoteDescription.type === 'offer') this._createAnswer()\n        })\n        .catch(err => {\n          this.destroy(errCode(err, 'ERR_SET_REMOTE_DESCRIPTION'))\n        })\n    }\n    if (!data.sdp && !data.candidate && !data.renegotiate && !data.transceiverRequest) {\n      this.destroy(errCode(new Error('signal() called with invalid signal data'), 'ERR_SIGNALING'))\n    }\n  }\n\n  _addIceCandidate (candidate) {\n    const iceCandidateObj = new this._wrtc.RTCIceCandidate(candidate)\n    this._pc.addIceCandidate(iceCandidateObj)\n      .catch(err => {\n        if (!iceCandidateObj.address || iceCandidateObj.address.endsWith('.local')) {\n          warn('Ignoring unsupported ICE candidate.')\n        } else {\n          this.destroy(errCode(err, 'ERR_ADD_ICE_CANDIDATE'))\n        }\n      })\n  }\n\n  /**\n   * Send text/binary data to the remote peer.\n   * @param {ArrayBufferView|ArrayBuffer|Buffer|string|Blob} chunk\n   */\n  send (chunk) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot send after peer is destroyed'), 'ERR_DESTROYED')\n    this._channel.send(chunk)\n  }\n\n  /**\n   * Add a Transceiver to the connection.\n   * @param {String} kind\n   * @param {Object} init\n   */\n  addTransceiver (kind, init) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot addTransceiver after peer is destroyed'), 'ERR_DESTROYED')\n    this._debug('addTransceiver()')\n\n    if (this.initiator) {\n      try {\n        this._pc.addTransceiver(kind, init)\n        this._needsNegotiation()\n      } catch (err) {\n        this.destroy(errCode(err, 'ERR_ADD_TRANSCEIVER'))\n      }\n    } else {\n      this.emit('signal', { // request initiator to renegotiate\n        type: 'transceiverRequest',\n        transceiverRequest: { kind, init }\n      })\n    }\n  }\n\n  /**\n   * Add a MediaStream to the connection.\n   * @param {MediaStream} stream\n   */\n  addStream (stream) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot addStream after peer is destroyed'), 'ERR_DESTROYED')\n    this._debug('addStream()')\n\n    stream.getTracks().forEach(track => {\n      this.addTrack(track, stream)\n    })\n  }\n\n  /**\n   * Add a MediaStreamTrack to the connection.\n   * @param {MediaStreamTrack} track\n   * @param {MediaStream} stream\n   */\n  addTrack (track, stream) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot addTrack after peer is destroyed'), 'ERR_DESTROYED')\n    this._debug('addTrack()')\n\n    const submap = this._senderMap.get(track) || new Map() // nested Maps map [track, stream] to sender\n    let sender = submap.get(stream)\n    if (!sender) {\n      sender = this._pc.addTrack(track, stream)\n      submap.set(stream, sender)\n      this._senderMap.set(track, submap)\n      this._needsNegotiation()\n    } else if (sender.removed) {\n      throw errCode(new Error('Track has been removed. You should enable/disable tracks that you want to re-add.'), 'ERR_SENDER_REMOVED')\n    } else {\n      throw errCode(new Error('Track has already been added to that stream.'), 'ERR_SENDER_ALREADY_ADDED')\n    }\n  }\n\n  /**\n   * Replace a MediaStreamTrack by another in the connection.\n   * @param {MediaStreamTrack} oldTrack\n   * @param {MediaStreamTrack} newTrack\n   * @param {MediaStream} stream\n   */\n  replaceTrack (oldTrack, newTrack, stream) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot replaceTrack after peer is destroyed'), 'ERR_DESTROYED')\n    this._debug('replaceTrack()')\n\n    const submap = this._senderMap.get(oldTrack)\n    const sender = submap ? submap.get(stream) : null\n    if (!sender) {\n      throw errCode(new Error('Cannot replace track that was never added.'), 'ERR_TRACK_NOT_ADDED')\n    }\n    if (newTrack) this._senderMap.set(newTrack, submap)\n\n    if (sender.replaceTrack != null) {\n      sender.replaceTrack(newTrack)\n    } else {\n      this.destroy(errCode(new Error('replaceTrack is not supported in this browser'), 'ERR_UNSUPPORTED_REPLACETRACK'))\n    }\n  }\n\n  /**\n   * Remove a MediaStreamTrack from the connection.\n   * @param {MediaStreamTrack} track\n   * @param {MediaStream} stream\n   */\n  removeTrack (track, stream) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot removeTrack after peer is destroyed'), 'ERR_DESTROYED')\n    this._debug('removeSender()')\n\n    const submap = this._senderMap.get(track)\n    const sender = submap ? submap.get(stream) : null\n    if (!sender) {\n      throw errCode(new Error('Cannot remove track that was never added.'), 'ERR_TRACK_NOT_ADDED')\n    }\n    try {\n      sender.removed = true\n      this._pc.removeTrack(sender)\n    } catch (err) {\n      if (err.name === 'NS_ERROR_UNEXPECTED') {\n        this._sendersAwaitingStable.push(sender) // HACK: Firefox must wait until (signalingState === stable) https://bugzilla.mozilla.org/show_bug.cgi?id=1133874\n      } else {\n        this.destroy(errCode(err, 'ERR_REMOVE_TRACK'))\n      }\n    }\n    this._needsNegotiation()\n  }\n\n  /**\n   * Remove a MediaStream from the connection.\n   * @param {MediaStream} stream\n   */\n  removeStream (stream) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot removeStream after peer is destroyed'), 'ERR_DESTROYED')\n    this._debug('removeSenders()')\n\n    stream.getTracks().forEach(track => {\n      this.removeTrack(track, stream)\n    })\n  }\n\n  _needsNegotiation () {\n    this._debug('_needsNegotiation')\n    if (this._batchedNegotiation) return // batch synchronous renegotiations\n    this._batchedNegotiation = true\n    queueMicrotask(() => {\n      this._batchedNegotiation = false\n      if (this.initiator || !this._firstNegotiation) {\n        this._debug('starting batched negotiation')\n        this.negotiate()\n      } else {\n        this._debug('non-initiator initial negotiation request discarded')\n      }\n      this._firstNegotiation = false\n    })\n  }\n\n  negotiate () {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot negotiate after peer is destroyed'), 'ERR_DESTROYED')\n\n    if (this.initiator) {\n      if (this._isNegotiating) {\n        this._queuedNegotiation = true\n        this._debug('already negotiating, queueing')\n      } else {\n        this._debug('start negotiation')\n        setTimeout(() => { // HACK: Chrome crashes if we immediately call createOffer\n          this._createOffer()\n        }, 0)\n      }\n    } else {\n      if (this._isNegotiating) {\n        this._queuedNegotiation = true\n        this._debug('already negotiating, queueing')\n      } else {\n        this._debug('requesting negotiation from initiator')\n        this.emit('signal', { // request initiator to renegotiate\n          type: 'renegotiate',\n          renegotiate: true\n        })\n      }\n    }\n    this._isNegotiating = true\n  }\n\n  // TODO: Delete this method once readable-stream is updated to contain a default\n  // implementation of destroy() that automatically calls _destroy()\n  // See: https://github.com/nodejs/readable-stream/issues/283\n  destroy (err) {\n    this._destroy(err, () => {})\n  }\n\n  _destroy (err, cb) {\n    if (this.destroyed || this.destroying) return\n    this.destroying = true\n\n    this._debug('destroying (error: %s)', err && (err.message || err))\n\n    queueMicrotask(() => { // allow events concurrent with the call to _destroy() to fire (see #692)\n      this.destroyed = true\n      this.destroying = false\n\n      this._debug('destroy (error: %s)', err && (err.message || err))\n\n      this.readable = this.writable = false\n\n      if (!this._readableState.ended) this.push(null)\n      if (!this._writableState.finished) this.end()\n\n      this._connected = false\n      this._pcReady = false\n      this._channelReady = false\n      this._remoteTracks = null\n      this._remoteStreams = null\n      this._senderMap = null\n\n      clearInterval(this._closingInterval)\n      this._closingInterval = null\n\n      clearInterval(this._interval)\n      this._interval = null\n      this._chunk = null\n      this._cb = null\n\n      if (this._onFinishBound) this.removeListener('finish', this._onFinishBound)\n      this._onFinishBound = null\n\n      if (this._channel) {\n        try {\n          this._channel.close()\n        } catch (err) {}\n\n        // allow events concurrent with destruction to be handled\n        this._channel.onmessage = null\n        this._channel.onopen = null\n        this._channel.onclose = null\n        this._channel.onerror = null\n      }\n      if (this._pc) {\n        try {\n          this._pc.close()\n        } catch (err) {}\n\n        // allow events concurrent with destruction to be handled\n        this._pc.oniceconnectionstatechange = null\n        this._pc.onicegatheringstatechange = null\n        this._pc.onsignalingstatechange = null\n        this._pc.onicecandidate = null\n        this._pc.ontrack = null\n        this._pc.ondatachannel = null\n      }\n      this._pc = null\n      this._channel = null\n\n      if (err) this.emit('error', err)\n      this.emit('close')\n      cb()\n    })\n  }\n\n  _setupData (event) {\n    if (!event.channel) {\n      // In some situations `pc.createDataChannel()` returns `undefined` (in wrtc),\n      // which is invalid behavior. Handle it gracefully.\n      // See: https://github.com/feross/simple-peer/issues/163\n      return this.destroy(errCode(new Error('Data channel event is missing `channel` property'), 'ERR_DATA_CHANNEL'))\n    }\n\n    this._channel = event.channel\n    this._channel.binaryType = 'arraybuffer'\n\n    if (typeof this._channel.bufferedAmountLowThreshold === 'number') {\n      this._channel.bufferedAmountLowThreshold = MAX_BUFFERED_AMOUNT\n    }\n\n    this.channelName = this._channel.label\n\n    this._channel.onmessage = event => {\n      this._onChannelMessage(event)\n    }\n    this._channel.onbufferedamountlow = () => {\n      this._onChannelBufferedAmountLow()\n    }\n    this._channel.onopen = () => {\n      this._onChannelOpen()\n    }\n    this._channel.onclose = () => {\n      this._onChannelClose()\n    }\n    this._channel.onerror = event => {\n      const err = event.error instanceof Error\n        ? event.error\n        : new Error(`Datachannel error: ${event.message} ${event.filename}:${event.lineno}:${event.colno}`)\n      this.destroy(errCode(err, 'ERR_DATA_CHANNEL'))\n    }\n\n    // HACK: Chrome will sometimes get stuck in readyState \"closing\", let's check for this condition\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=882743\n    let isClosing = false\n    this._closingInterval = setInterval(() => { // No \"onclosing\" event\n      if (this._channel && this._channel.readyState === 'closing') {\n        if (isClosing) this._onChannelClose() // closing timed out: equivalent to onclose firing\n        isClosing = true\n      } else {\n        isClosing = false\n      }\n    }, CHANNEL_CLOSING_TIMEOUT)\n  }\n\n  _read () {}\n\n  _write (chunk, encoding, cb) {\n    if (this.destroyed) return cb(errCode(new Error('cannot write after peer is destroyed'), 'ERR_DATA_CHANNEL'))\n\n    if (this._connected) {\n      try {\n        this.send(chunk)\n      } catch (err) {\n        return this.destroy(errCode(err, 'ERR_DATA_CHANNEL'))\n      }\n      if (this._channel.bufferedAmount > MAX_BUFFERED_AMOUNT) {\n        this._debug('start backpressure: bufferedAmount %d', this._channel.bufferedAmount)\n        this._cb = cb\n      } else {\n        cb(null)\n      }\n    } else {\n      this._debug('write before connect')\n      this._chunk = chunk\n      this._cb = cb\n    }\n  }\n\n  // When stream finishes writing, close socket. Half open connections are not\n  // supported.\n  _onFinish () {\n    if (this.destroyed) return\n\n    // Wait a bit before destroying so the socket flushes.\n    // TODO: is there a more reliable way to accomplish this?\n    const destroySoon = () => {\n      setTimeout(() => this.destroy(), 1000)\n    }\n\n    if (this._connected) {\n      destroySoon()\n    } else {\n      this.once('connect', destroySoon)\n    }\n  }\n\n  _startIceCompleteTimeout () {\n    if (this.destroyed) return\n    if (this._iceCompleteTimer) return\n    this._debug('started iceComplete timeout')\n    this._iceCompleteTimer = setTimeout(() => {\n      if (!this._iceComplete) {\n        this._iceComplete = true\n        this._debug('iceComplete timeout completed')\n        this.emit('iceTimeout')\n        this.emit('_iceComplete')\n      }\n    }, this.iceCompleteTimeout)\n  }\n\n  _createOffer () {\n    if (this.destroyed) return\n\n    this._pc.createOffer(this.offerOptions)\n      .then(offer => {\n        if (this.destroyed) return\n        if (!this.trickle && !this.allowHalfTrickle) offer.sdp = filterTrickle(offer.sdp)\n        offer.sdp = this.sdpTransform(offer.sdp)\n\n        const sendOffer = () => {\n          if (this.destroyed) return\n          const signal = this._pc.localDescription || offer\n          this._debug('signal')\n          this.emit('signal', {\n            type: signal.type,\n            sdp: signal.sdp\n          })\n        }\n\n        const onSuccess = () => {\n          this._debug('createOffer success')\n          if (this.destroyed) return\n          if (this.trickle || this._iceComplete) sendOffer()\n          else this.once('_iceComplete', sendOffer) // wait for candidates\n        }\n\n        const onError = err => {\n          this.destroy(errCode(err, 'ERR_SET_LOCAL_DESCRIPTION'))\n        }\n\n        this._pc.setLocalDescription(offer)\n          .then(onSuccess)\n          .catch(onError)\n      })\n      .catch(err => {\n        this.destroy(errCode(err, 'ERR_CREATE_OFFER'))\n      })\n  }\n\n  _requestMissingTransceivers () {\n    if (this._pc.getTransceivers) {\n      this._pc.getTransceivers().forEach(transceiver => {\n        if (!transceiver.mid && transceiver.sender.track && !transceiver.requested) {\n          transceiver.requested = true // HACK: Safari returns negotiated transceivers with a null mid\n          this.addTransceiver(transceiver.sender.track.kind)\n        }\n      })\n    }\n  }\n\n  _createAnswer () {\n    if (this.destroyed) return\n\n    this._pc.createAnswer(this.answerOptions)\n      .then(answer => {\n        if (this.destroyed) return\n        if (!this.trickle && !this.allowHalfTrickle) answer.sdp = filterTrickle(answer.sdp)\n        answer.sdp = this.sdpTransform(answer.sdp)\n\n        const sendAnswer = () => {\n          if (this.destroyed) return\n          const signal = this._pc.localDescription || answer\n          this._debug('signal')\n          this.emit('signal', {\n            type: signal.type,\n            sdp: signal.sdp\n          })\n          if (!this.initiator) this._requestMissingTransceivers()\n        }\n\n        const onSuccess = () => {\n          if (this.destroyed) return\n          if (this.trickle || this._iceComplete) sendAnswer()\n          else this.once('_iceComplete', sendAnswer)\n        }\n\n        const onError = err => {\n          this.destroy(errCode(err, 'ERR_SET_LOCAL_DESCRIPTION'))\n        }\n\n        this._pc.setLocalDescription(answer)\n          .then(onSuccess)\n          .catch(onError)\n      })\n      .catch(err => {\n        this.destroy(errCode(err, 'ERR_CREATE_ANSWER'))\n      })\n  }\n\n  _onConnectionStateChange () {\n    if (this.destroyed) return\n    if (this._pc.connectionState === 'failed') {\n      this.destroy(errCode(new Error('Connection failed.'), 'ERR_CONNECTION_FAILURE'))\n    }\n  }\n\n  _onIceStateChange () {\n    if (this.destroyed) return\n    const iceConnectionState = this._pc.iceConnectionState\n    const iceGatheringState = this._pc.iceGatheringState\n\n    this._debug(\n      'iceStateChange (connection: %s) (gathering: %s)',\n      iceConnectionState,\n      iceGatheringState\n    )\n    this.emit('iceStateChange', iceConnectionState, iceGatheringState)\n\n    if (iceConnectionState === 'connected' || iceConnectionState === 'completed') {\n      this._pcReady = true\n      this._maybeReady()\n    }\n    if (iceConnectionState === 'failed') {\n      this.destroy(errCode(new Error('Ice connection failed.'), 'ERR_ICE_CONNECTION_FAILURE'))\n    }\n    if (iceConnectionState === 'closed') {\n      this.destroy(errCode(new Error('Ice connection closed.'), 'ERR_ICE_CONNECTION_CLOSED'))\n    }\n  }\n\n  getStats (cb) {\n    // statreports can come with a value array instead of properties\n    const flattenValues = report => {\n      if (Object.prototype.toString.call(report.values) === '[object Array]') {\n        report.values.forEach(value => {\n          Object.assign(report, value)\n        })\n      }\n      return report\n    }\n\n    // Promise-based getStats() (standard)\n    if (this._pc.getStats.length === 0 || this._isReactNativeWebrtc) {\n      this._pc.getStats()\n        .then(res => {\n          const reports = []\n          res.forEach(report => {\n            reports.push(flattenValues(report))\n          })\n          cb(null, reports)\n        }, err => cb(err))\n\n    // Single-parameter callback-based getStats() (non-standard)\n    } else if (this._pc.getStats.length > 0) {\n      this._pc.getStats(res => {\n        // If we destroy connection in `connect` callback this code might happen to run when actual connection is already closed\n        if (this.destroyed) return\n\n        const reports = []\n        res.result().forEach(result => {\n          const report = {}\n          result.names().forEach(name => {\n            report[name] = result.stat(name)\n          })\n          report.id = result.id\n          report.type = result.type\n          report.timestamp = result.timestamp\n          reports.push(flattenValues(report))\n        })\n        cb(null, reports)\n      }, err => cb(err))\n\n    // Unknown browser, skip getStats() since it's anyone's guess which style of\n    // getStats() they implement.\n    } else {\n      cb(null, [])\n    }\n  }\n\n  _maybeReady () {\n    this._debug('maybeReady pc %s channel %s', this._pcReady, this._channelReady)\n    if (this._connected || this._connecting || !this._pcReady || !this._channelReady) return\n\n    this._connecting = true\n\n    // HACK: We can't rely on order here, for details see https://github.com/js-platform/node-webrtc/issues/339\n    const findCandidatePair = () => {\n      if (this.destroyed) return\n\n      this.getStats((err, items) => {\n        if (this.destroyed) return\n\n        // Treat getStats error as non-fatal. It's not essential.\n        if (err) items = []\n\n        const remoteCandidates = {}\n        const localCandidates = {}\n        const candidatePairs = {}\n        let foundSelectedCandidatePair = false\n\n        items.forEach(item => {\n          // TODO: Once all browsers support the hyphenated stats report types, remove\n          // the non-hypenated ones\n          if (item.type === 'remotecandidate' || item.type === 'remote-candidate') {\n            remoteCandidates[item.id] = item\n          }\n          if (item.type === 'localcandidate' || item.type === 'local-candidate') {\n            localCandidates[item.id] = item\n          }\n          if (item.type === 'candidatepair' || item.type === 'candidate-pair') {\n            candidatePairs[item.id] = item\n          }\n        })\n\n        const setSelectedCandidatePair = selectedCandidatePair => {\n          foundSelectedCandidatePair = true\n\n          let local = localCandidates[selectedCandidatePair.localCandidateId]\n\n          if (local && (local.ip || local.address)) {\n            // Spec\n            this.localAddress = local.ip || local.address\n            this.localPort = Number(local.port)\n          } else if (local && local.ipAddress) {\n            // Firefox\n            this.localAddress = local.ipAddress\n            this.localPort = Number(local.portNumber)\n          } else if (typeof selectedCandidatePair.googLocalAddress === 'string') {\n            // TODO: remove this once Chrome 58 is released\n            local = selectedCandidatePair.googLocalAddress.split(':')\n            this.localAddress = local[0]\n            this.localPort = Number(local[1])\n          }\n          if (this.localAddress) {\n            this.localFamily = this.localAddress.includes(':') ? 'IPv6' : 'IPv4'\n          }\n\n          let remote = remoteCandidates[selectedCandidatePair.remoteCandidateId]\n\n          if (remote && (remote.ip || remote.address)) {\n            // Spec\n            this.remoteAddress = remote.ip || remote.address\n            this.remotePort = Number(remote.port)\n          } else if (remote && remote.ipAddress) {\n            // Firefox\n            this.remoteAddress = remote.ipAddress\n            this.remotePort = Number(remote.portNumber)\n          } else if (typeof selectedCandidatePair.googRemoteAddress === 'string') {\n            // TODO: remove this once Chrome 58 is released\n            remote = selectedCandidatePair.googRemoteAddress.split(':')\n            this.remoteAddress = remote[0]\n            this.remotePort = Number(remote[1])\n          }\n          if (this.remoteAddress) {\n            this.remoteFamily = this.remoteAddress.includes(':') ? 'IPv6' : 'IPv4'\n          }\n\n          this._debug(\n            'connect local: %s:%s remote: %s:%s',\n            this.localAddress,\n            this.localPort,\n            this.remoteAddress,\n            this.remotePort\n          )\n        }\n\n        items.forEach(item => {\n          // Spec-compliant\n          if (item.type === 'transport' && item.selectedCandidatePairId) {\n            setSelectedCandidatePair(candidatePairs[item.selectedCandidatePairId])\n          }\n\n          // Old implementations\n          if (\n            (item.type === 'googCandidatePair' && item.googActiveConnection === 'true') ||\n            ((item.type === 'candidatepair' || item.type === 'candidate-pair') && item.selected)\n          ) {\n            setSelectedCandidatePair(item)\n          }\n        })\n\n        // Ignore candidate pair selection in browsers like Safari 11 that do not have any local or remote candidates\n        // But wait until at least 1 candidate pair is available\n        if (!foundSelectedCandidatePair && (!Object.keys(candidatePairs).length || Object.keys(localCandidates).length)) {\n          setTimeout(findCandidatePair, 100)\n          return\n        } else {\n          this._connecting = false\n          this._connected = true\n        }\n\n        if (this._chunk) {\n          try {\n            this.send(this._chunk)\n          } catch (err) {\n            return this.destroy(errCode(err, 'ERR_DATA_CHANNEL'))\n          }\n          this._chunk = null\n          this._debug('sent chunk from \"write before connect\"')\n\n          const cb = this._cb\n          this._cb = null\n          cb(null)\n        }\n\n        // If `bufferedAmountLowThreshold` and 'onbufferedamountlow' are unsupported,\n        // fallback to using setInterval to implement backpressure.\n        if (typeof this._channel.bufferedAmountLowThreshold !== 'number') {\n          this._interval = setInterval(() => this._onInterval(), 150)\n          if (this._interval.unref) this._interval.unref()\n        }\n\n        this._debug('connect')\n        this.emit('connect')\n      })\n    }\n    findCandidatePair()\n  }\n\n  _onInterval () {\n    if (!this._cb || !this._channel || this._channel.bufferedAmount > MAX_BUFFERED_AMOUNT) {\n      return\n    }\n    this._onChannelBufferedAmountLow()\n  }\n\n  _onSignalingStateChange () {\n    if (this.destroyed) return\n\n    if (this._pc.signalingState === 'stable') {\n      this._isNegotiating = false\n\n      // HACK: Firefox doesn't yet support removing tracks when signalingState !== 'stable'\n      this._debug('flushing sender queue', this._sendersAwaitingStable)\n      this._sendersAwaitingStable.forEach(sender => {\n        this._pc.removeTrack(sender)\n        this._queuedNegotiation = true\n      })\n      this._sendersAwaitingStable = []\n\n      if (this._queuedNegotiation) {\n        this._debug('flushing negotiation queue')\n        this._queuedNegotiation = false\n        this._needsNegotiation() // negotiate again\n      } else {\n        this._debug('negotiated')\n        this.emit('negotiated')\n      }\n    }\n\n    this._debug('signalingStateChange %s', this._pc.signalingState)\n    this.emit('signalingStateChange', this._pc.signalingState)\n  }\n\n  _onIceCandidate (event) {\n    if (this.destroyed) return\n    if (event.candidate && this.trickle) {\n      this.emit('signal', {\n        type: 'candidate',\n        candidate: {\n          candidate: event.candidate.candidate,\n          sdpMLineIndex: event.candidate.sdpMLineIndex,\n          sdpMid: event.candidate.sdpMid\n        }\n      })\n    } else if (!event.candidate && !this._iceComplete) {\n      this._iceComplete = true\n      this.emit('_iceComplete')\n    }\n    // as soon as we've received one valid candidate start timeout\n    if (event.candidate) {\n      this._startIceCompleteTimeout()\n    }\n  }\n\n  _onChannelMessage (event) {\n    if (this.destroyed) return\n    let data = event.data\n    if (data instanceof ArrayBuffer) data = Buffer.from(data)\n    this.push(data)\n  }\n\n  _onChannelBufferedAmountLow () {\n    if (this.destroyed || !this._cb) return\n    this._debug('ending backpressure: bufferedAmount %d', this._channel.bufferedAmount)\n    const cb = this._cb\n    this._cb = null\n    cb(null)\n  }\n\n  _onChannelOpen () {\n    if (this._connected || this.destroyed) return\n    this._debug('on channel open')\n    this._channelReady = true\n    this._maybeReady()\n  }\n\n  _onChannelClose () {\n    if (this.destroyed) return\n    this._debug('on channel close')\n    this.destroy()\n  }\n\n  _onTrack (event) {\n    if (this.destroyed) return\n\n    event.streams.forEach(eventStream => {\n      this._debug('on track')\n      this.emit('track', event.track, eventStream)\n\n      this._remoteTracks.push({\n        track: event.track,\n        stream: eventStream\n      })\n\n      if (this._remoteStreams.some(remoteStream => {\n        return remoteStream.id === eventStream.id\n      })) return // Only fire one 'stream' event, even though there may be multiple tracks per stream\n\n      this._remoteStreams.push(eventStream)\n      queueMicrotask(() => {\n        this._debug('on stream')\n        this.emit('stream', eventStream) // ensure all tracks have been added\n      })\n    })\n  }\n\n  _debug () {\n    const args = [].slice.call(arguments)\n    args[0] = '[' + this._id + '] ' + args[0]\n    debug.apply(null, args)\n  }\n}\n\nPeer.WEBRTC_SUPPORT = !!getBrowserRTC()\n\n/**\n * Expose peer and data channel config for overriding all Peer\n * instances. Otherwise, just set opts.config or opts.channelConfig\n * when constructing a Peer.\n */\nPeer.config = {\n  iceServers: [\n    {\n      urls: [\n        'stun:stun.l.google.com:19302',\n        'stun:global.stun.twilio.com:3478'\n      ]\n    }\n  ],\n  sdpSemantics: 'unified-plan'\n}\n\nPeer.channelConfig = {}\n\nmodule.exports = Peer\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}