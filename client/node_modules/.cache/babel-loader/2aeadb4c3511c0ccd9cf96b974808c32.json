{"ast":null,"code":"import _slicedToArray from\"/home/giorgir/Desktop/web projects/discord-mern/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _toConsumableArray from\"/home/giorgir/Desktop/web projects/discord-mern/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import React,{useState,useEffect,useRef}from'react';import{socket}from'../js/_socketSide';import Peer from'simple-peer';import{MicSVGOff,MicSVGOn,CamSVGOff,CamSVGOn,ScreenShareOff,ScreenShareOn,FullScreen}from'../../styles/SVGs/_SVGs';import\"./_voice.sass\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var egress=function egress(history){history.push(\"/chat/61ed960432479c682956802b\");};var Frame=function Frame(_ref){var name=_ref.name,status=_ref.status,videoStream=_ref.videoStream;return/*#__PURE__*/_jsxs(\"div\",{className:\"frame\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"name\",children:[name,\":\"]}),/*#__PURE__*/_jsx(\"video\",{className:\"video\",autoPlay:true,controls:true,ref:videoStream}),/*#__PURE__*/_jsx(\"h4\",{className:\"statusLabel\",children:status})]});};var VoiceFrame=function VoiceFrame(_ref2){var history=_ref2.history,roomId=_ref2.roomId,userName=_ref2.userName;var setLabel=function setLabel(user,text){if(user===\"current\"){var newUsers=users;newUsers[0][1]=text;setUsers(_toConsumableArray(newUsers));}else{//pass\n}};var _useState=useState(),_useState2=_slicedToArray(_useState,2),mediaStream=_useState2[0],setMediaStream=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),users=_useState4[0],setUsers=_useState4[1];var videoStreams=[useRef(),useRef()];// [0] is of current device\nvar _useState5=useState({audio:false,video:true}),_useState6=_slicedToArray(_useState5,2),mediaData=_useState6[0],setMediaData=_useState6[1];useEffect(function(){setUsers([[userName,\"\"]]);// socket.emit(\"join voice\", {\n//     roomId: roomId,\n//     username: username,\n// });\nsocket.on(\"all users\",function(data){// pass\n});socket.on(\"user joined\",function(data){// pass\n});socket.on(\"new stream\",function(data){// pass\n});},[]);useEffect(function(){navigator.mediaDevices.getUserMedia(mediaData).then(function(stream){// console.log(stream);\nsetMediaStream(stream);videoStreams[0].current.srcObject=stream;// Todo: set media label to \"No Video\"\nif(!mediaData.video)setLabel(\"current\",\"No Video\");else setLabel(\"current\",\"\");}).catch(function(err){try{mediaStream.getTracks().forEach(function(track){return track.stop();});// Todo: set media label to \"No Signal\"\nsetLabel(\"current\",\"No Signal\");}catch(TypeError){// setLabel(\"current\", \"no video\");\n// console.log(\"no shit...\");\n}});},[mediaData]);useEffect(function(){console.log(\".......\");},[users]);return/*#__PURE__*/_jsxs(\"div\",{className:\"webrtc\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"windows\",children:users.map(function(user,n){return/*#__PURE__*/_jsx(Frame,{name:user[0],status:user[1],videoStream:videoStreams[n]});})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bottom\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"icons\",children:[mediaData.audio?/*#__PURE__*/_jsx(MicSVGOn,{mediaData:mediaData,setMediaData:setMediaData}):/*#__PURE__*/_jsx(MicSVGOff,{mediaData:mediaData,setMediaData:setMediaData}),mediaData.video?/*#__PURE__*/_jsx(CamSVGOn,{mediaData:mediaData,setMediaData:setMediaData}):/*#__PURE__*/_jsx(CamSVGOff,{mediaData:mediaData,setMediaData:setMediaData}),/*#__PURE__*/_jsx(ScreenShareOn,{mediaData:mediaData,setMediaData:setMediaData})]}),/*#__PURE__*/_jsx(\"button\",{className:\"egress\",onClick:function onClick(){return egress(history);},children:\"egress\"})]})]});};var screenShareOn=function screenShareOn(){// pass\n};var screenShareOff=function screenShareOff(){// pass\n};var webCamOn=function webCamOn(){// pass\n};var webCamOff=function webCamOff(){// pass\n};var micOn=function micOn(){// pass\n};var micOff=function micOff(){// pass\n};var checkMode=function checkMode(voiceMode,setStatusLabel){if(!voiceMode)setStatusLabel(\"invalid\");};export{VoiceFrame};","map":{"version":3,"names":["React","useState","useEffect","useRef","socket","Peer","MicSVGOff","MicSVGOn","CamSVGOff","CamSVGOn","ScreenShareOff","ScreenShareOn","FullScreen","egress","history","push","Frame","name","status","videoStream","VoiceFrame","roomId","userName","setLabel","user","text","newUsers","users","setUsers","mediaStream","setMediaStream","videoStreams","audio","video","mediaData","setMediaData","on","data","navigator","mediaDevices","getUserMedia","then","stream","current","srcObject","catch","err","getTracks","forEach","track","stop","TypeError","console","log","map","n","screenShareOn","screenShareOff","webCamOn","webCamOff","micOn","micOff","checkMode","voiceMode","setStatusLabel"],"sources":["/home/giorgir/Desktop/web projects/discord-mern/client/src/components/Voice/_voice.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\n\r\nimport { socket } from '../js/_socketSide';\r\n\r\nimport Peer from 'simple-peer';\r\n\r\nimport { MicSVGOff, MicSVGOn, CamSVGOff, CamSVGOn, ScreenShareOff, ScreenShareOn, FullScreen } from '../../styles/SVGs/_SVGs';\r\n\r\nimport \"./_voice.sass\";\r\n\r\nconst egress = (history) => {\r\n    history.push(\"/chat/61ed960432479c682956802b\");\r\n}\r\n\r\nconst Frame = ({ name, status, videoStream }) => (\r\n    <div className=\"frame\">\r\n        <h4 className=\"name\">{name}:</h4>\r\n        {/* style={{height: 150, width: 100}} */}\r\n        <video className=\"video\" autoPlay controls ref={videoStream} />\r\n        <h4 className=\"statusLabel\">{status}</h4>\r\n    </div>\r\n)\r\n\r\nconst VoiceFrame = ({ history, roomId, userName }) => {\r\n    const setLabel = (user, text) => {\r\n        if (user === \"current\"){\r\n            let newUsers = users;\r\n            newUsers[0][1] = text;\r\n            setUsers([...newUsers]);\r\n        }\r\n        else {\r\n            //pass\r\n        }\r\n    }\r\n\r\n    const [mediaStream, setMediaStream] = useState();\r\n\r\n    const [users, setUsers] = useState([]);\r\n\r\n    const videoStreams = [useRef(), useRef()]; // [0] is of current device\r\n\r\n    const [mediaData, setMediaData] = useState({ audio: false, video: true });\r\n\r\n    useEffect(() => {\r\n        setUsers([[userName, \"\"]]);\r\n        // socket.emit(\"join voice\", {\r\n        //     roomId: roomId,\r\n        //     username: username,\r\n        // });\r\n        \r\n        socket.on(\"all users\", data => {\r\n            // pass\r\n        });\r\n\r\n        socket.on(\"user joined\", data => {\r\n            // pass\r\n        });\r\n\r\n        socket.on(\"new stream\", data => {\r\n            // pass\r\n        });\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        navigator.mediaDevices.getUserMedia(mediaData)\r\n        .then(stream => {\r\n            // console.log(stream);\r\n            setMediaStream(stream);\r\n            videoStreams[0].current.srcObject = stream;\r\n\r\n            // Todo: set media label to \"No Video\"\r\n            if (!mediaData.video)\r\n                setLabel(\"current\", \"No Video\");\r\n            else\r\n                setLabel(\"current\", \"\");\r\n        })\r\n        .catch(err => {\r\n            try {\r\n                mediaStream.getTracks().forEach(track => track.stop());\r\n                // Todo: set media label to \"No Signal\"\r\n                setLabel(\"current\", \"No Signal\");\r\n            }\r\n            catch (TypeError){\r\n                // setLabel(\"current\", \"no video\");\r\n                // console.log(\"no shit...\");\r\n            }\r\n        });\r\n    }, [mediaData]);\r\n\r\n    useEffect(() => {\r\n        console.log(\".......\")\r\n    }, [users]);\r\n\r\n    return(\r\n        <div className=\"webrtc\">\r\n            <div className=\"windows\">\r\n                {users.map((user, n) => <Frame name={user[0]} status={user[1]} videoStream={videoStreams[n]} />)}\r\n            </div>\r\n\r\n            <div className=\"bottom\">\r\n                <div className=\"icons\">\r\n                    {mediaData.audio ?\r\n                    <MicSVGOn mediaData={mediaData} setMediaData={setMediaData} />\r\n                    :\r\n                    <MicSVGOff mediaData={mediaData} setMediaData={setMediaData} />\r\n                    }\r\n                    {mediaData.video ?\r\n                    <CamSVGOn mediaData={mediaData} setMediaData={setMediaData} />\r\n                    :\r\n                    <CamSVGOff mediaData={mediaData} setMediaData={setMediaData} />\r\n                    }\r\n                    \r\n                    <ScreenShareOn mediaData={mediaData} setMediaData={setMediaData} />\r\n                </div>\r\n                <button className=\"egress\" onClick={() => egress(history)}>egress</button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst screenShareOn = () => {\r\n    // pass\r\n}\r\n\r\nconst screenShareOff = () => {\r\n    // pass\r\n}\r\n\r\nconst webCamOn = () => {\r\n    // pass\r\n}\r\n\r\nconst webCamOff = () => {\r\n    // pass\r\n}\r\n\r\nconst micOn = () => {\r\n    // pass\r\n}\r\n\r\nconst micOff = () => {\r\n    // pass\r\n}\r\n\r\nconst checkMode = (voiceMode, setStatusLabel) => {\r\n    if (!voiceMode)\r\n        setStatusLabel(\"invalid\");\r\n}\r\n\r\nexport {\r\n    VoiceFrame,\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}